[defaults]
inventory = ./inventory/aws_ec2.yml  # Points to our dynamic inventory
stdout_callback = yaml               # Nicer output format
host_key_checking = False            # IMPORTANT: This is for Ansible's own internal check, NOT SSH directly.
                                     # With SSM, this is less critical but can prevent warnings.

[privilege_escalation]
become = true                        # Enable privilege escalation by default
become_method = sudo                 # Use sudo for escalation
become_user = root                   # Become root user

[ssh_connection]
# When using the AWS SSM connection plugin, direct SSH settings are mostly ignored.
# However, if you ever fall back to SSH for debugging, ensure no insecure defaults.
control_path = %(directory)s/%%h-%%r
pipelining = true
ssh_args = -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=publickey,gssapi-with-mic -o StrictHostKeyChecking=no # StrictHostKeyChecking is temporary for testing, ensure this is not in prod